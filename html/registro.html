<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <title>
    <| DND BUILDER |>
  </title>
  <!--estilo y js inicio-->
  <link rel='stylesheet' type='text/css' media='screen' href='../styles/pupils.css'>
  <script src='../scripts/dentrites.js'></script>
  <!--JQuery-->
  <script src="../lib/jquery-3.4.1.min.js"></script>
  <!--Bootstrap-->
  <script src='../scripts/bootstrap.bundle.js'></script>
  <link rel='stylesheet' type='text/css' media='screen' href='../styles/bootstrap.css'>
  <!--Sweet alert-->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


</head>

<body id="index-bg">
  <div id="container">
    <div id="indexcontent">
      <div id="log">
        <h3 style="color:black;margin: 0px 70px 20px;text-decoration: underline;text-decoration-thickness:2px;">Registro
        </h3>

        <form method="post" id="login" name="registro_form" action="javascript:ajaxCall()">
          <label style="margin-left:85px ;" class="labInput">
            <center>Nick</center>
          </label>
          <input class="logger" id="userName" type="text" name='nick'>
          <label style="margin-left:25px ;" class="labInput">Correo Electronico</label>
          <input class="logger" id="userEmail" type="email" name='email'>
          <label style="margin-left: 55px;" class="labInput">Contrase&ntilde;a</label>
          <input class="logger" id="userPassword" type="password" name="password">
          <button id="Enviar" class="submitButton" type="submit">Enviar</button>
          <button id="retorno" class="submitButton" type="button" value="volver">Volver</button>
        </form>
        <div style="margin:10px 12px;font-size: 16px;font-family: 'Dalelands'">
          <a style="cursor: pointer;" data-bs-toggle="modal" data-bs-target="#exampleModal">¿Ya estas registrado?</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal HTML -->
  <div id="exampleModal" class="modal fade">
    <div class="modal-dialog modal-login">
      <div class="modal-content">
        <div class="modal-header">

          <h4 class="modal-title">Login</h4>
          <button type="button" class="close" data-bs-dismiss="modal" aria-hidden="true">&times;</button>
        </div>
        <div class="modal-body">
          <form action="#" method="post">
            <div class="form-group">
              <input type="text" class="form-control" name="username" placeholder="Usuario" required="required">
            </div>
            <br>
            <div class="form-group">
              <input type="password" class="form-control" name="password" placeholder="Password" required="required">
            </div>
            <br>
            <div class="form-group">
              <button type="submit" class="btn btn-primary btn-lg btn-block login-btn">Login</button>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <a href="#">¿Olvidaste la contraseña?</a>
        </div>
      </div>
    </div>
  </div>
</body>

<script>
  $('#retorno').click(function () {
    Swal.fire({
      position: 'top-end',
      icon: 'success',
      title: 'Volvemos al inicio',
      showConfirmButton: false,
      timer: 1200
    }).then(function () {
      window.location.href = "../html/principal.html";
    })
  })


  function ajaxCall() {
	var userName = document.getElementById("userName").value;
	var userEmail = document.getElementById("userEmail").value;
	var userPassword = document.getElementById("userPassword").value;
	var userData = { 'nick': userName, 'email': userEmail, 'password': userPassword }
	if (userName != "" && userEmail != "" && userPassword != "") {
    $.ajax({
      type: 'POST',
			dataType: 'json',
			url: 'newUserRegistered.php',
			data: userData,
			success: function (msg) {
				if (msg) {
          createCookie();
					Swal.fire({
            position: 'top-end',
						icon: 'success',
						title: "Bienvenido " + userName,
						showConfirmButton: false,
						timer: 1200,
					}).then(function () {
            window.location.href = "../html/usuario.html";
					})
				} else {
          alert("Cannot add to list !");
				}
			},
			data: userData
		});
  } else {
    Swal.fire({
			position: 'top-end',
			icon: 'error',
			title: 'rellene todos los campos',
			showConfirmButton: false,
			timer: 1200
		})
	}
}
</script>

</html>